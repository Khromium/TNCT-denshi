mp5ex03.txt


1.課題
プッシュスイッチ０を1回押すごとに，LEDの点灯，消灯の切り替えが起こり，
何回でも繰り返すことができるプログラム。
正確に言うとプッシュスイッチを押したときには現在の点灯状態はまだ変化せず
プッシュスイッチから指を離した瞬間に点灯状態が反転するように作りなさい。
注意深く100回ほどプッシュスイッチを押して動作を観察しなさい。
点灯消灯の交互リズムが崩れ，不安定な動作が起こるかもしれない。「チャタリング」について調べること。

2.使用したプログラム
/**********************************************************
プッシュスイッチによってLEDのON-OFFを行う
**********************************************************/
#include <3048fone.h>
#include "h8_3048fone.h"

void waitmsec(int msec)
/*msec間なにもしない時間稼ぎ関数*/
{
    int i,j;
    for (i=0;i<msec;i++) {
        for (j=0;j<4190;j++);    /*4190は実測によって求めた値 25MHz駆動*/
    }
}

void pushreleaseSW(void)
/*プッシュスイッチが押されるまで待って，*/
/*その後離されるまで待つ関数　　　　　　*/
{
    while (checkPushSW(0)==0);
    while (checkPushSW(0)==1);
}

main()
{
    initLed();
    initPushSW();/*PushSWの初期化*/
    while(1) {
        pushreleaseSW();
        turnOffLed(0);
        turnOnLed(1);
        pushreleaseSW();
        turnOffLed(1);
        turnOnLed(0);
    }
}


3.考察
ボタンを押すたびにLEDの点灯・消灯が変わったが，時折，チャタリングを起こし，点灯が乱れていた．

チャタリングについて
可動接点などが接触状態になる際に，微細な非常に速い機械的振動を起こす現象のことである。

4.まとめ
プッシュスイッチを押しただけの判断だとチャタリングが起こりやすいので一定時間操作の間隔を取るなどの対策が必要である．